<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Iteration Examples | Functions and Iterations</title>
  <meta name="description" content="1 Iteration Examples | Functions and Iterations" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Iteration Examples | Functions and Iterations" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="d-rug/realworld_functions2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Iteration Examples | Functions and Iterations" />
  
  
  

<meta name="author" content="Reed Kenny and Tara Pozzi" />


<meta name="date" content="2023-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="iteration.html"/>
<link rel="next" href="final-plot.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://d-rug.github.io/">
  <img src="https://github.com/d-rug/d-rug.github.io/raw/main/DRUG_final_cobalt.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Functions and Iterations</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="functions-can-be-like-personalized-mini-packages.html"><a href="functions-can-be-like-personalized-mini-packages.html"><i class="fa fa-check"></i>Functions can be like personalized Mini Packages</a></li>
<li class="chapter" data-level="" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i>Iteration</a>
<ul>
<li class="chapter" data-level="0.1" data-path="iteration.html"><a href="iteration.html#objective"><i class="fa fa-check"></i><b>0.1</b> Objective</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="iteration-examples.html"><a href="iteration-examples.html"><i class="fa fa-check"></i><b>1</b> Iteration Examples</a>
<ul>
<li class="chapter" data-level="1.1" data-path="iteration-examples.html"><a href="iteration-examples.html#for-loops"><i class="fa fa-check"></i><b>1.1</b> For Loops</a></li>
<li class="chapter" data-level="1.2" data-path="iteration-examples.html"><a href="iteration-examples.html#apply-functions"><i class="fa fa-check"></i><b>1.2</b> Apply functions</a></li>
<li class="chapter" data-level="1.3" data-path="iteration-examples.html"><a href="iteration-examples.html#map-functions"><i class="fa fa-check"></i><b>1.3</b> Map functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="final-plot.html"><a href="final-plot.html"><i class="fa fa-check"></i><b>2</b> Final Plot</a></li>
<li class="divider"></li>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg" style="float: right; padding-right: 10px;" />
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Functions and Iterations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="iteration-examples" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Iteration Examples<a href="iteration-examples.html#iteration-examples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="for-loops" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> For Loops<a href="iteration-examples.html#for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, let’s use this function to download data for other species of Fraxinus. The first method I’ll will use is For Loops, which essentially repeats the code you’ve written across different input values (i). For example,</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="iteration-examples.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb10-2"><a href="iteration-examples.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb10-3"><a href="iteration-examples.html#cb10-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p>We will need to create an empty dataframe to save the results of the loop</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="iteration-examples.html#cb12-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb12-2"><a href="iteration-examples.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="iteration-examples.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb12-4"><a href="iteration-examples.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  results[i] <span class="ot">&lt;-</span> i<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb12-5"><a href="iteration-examples.html#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s try to translate this to the GBIF example.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="iteration-examples.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s try bringing in multiple species</span></span>
<span id="cb13-2"><a href="iteration-examples.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## create list of all Fraxinus species</span></span>
<span id="cb13-3"><a href="iteration-examples.html#cb13-3" aria-hidden="true" tabindex="-1"></a>species_names <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;fraxinus_species.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#I scraped this list off the GBIF website</span></span>
<span id="cb13-4"><a href="iteration-examples.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Name)<span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="iteration-examples.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() </span>
<span id="cb13-6"><a href="iteration-examples.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="iteration-examples.html#cb13-7" aria-hidden="true" tabindex="-1"></a>species_names</span></code></pre></div>
<pre><code>## $Name
##  [1] &quot;Fraxinus albicans Buckley&quot; &quot;Fraxinus americana&quot;       
##  [3] &quot;Fraxinus angustifolia&quot;     &quot;Fraxinus anomala&quot;         
##  [5] &quot;Fraxinus apertisquamifera&quot; &quot;Fraxinus baroniana&quot;       
##  [7] &quot;Fraxinus berlandieriana&quot;   &quot;Fraxinus bornmuelleri&quot;    
##  [9] &quot;Fraxinus bungeana&quot;         &quot;Fraxinus caroliniana&quot;     
## [11] &quot;Fraxinus chiisanensis&quot;     &quot;Fraxinus chinensis&quot;       
## [13] &quot;Fraxinus cuspidata&quot;        &quot;Fraxinus depauperata&quot;     
## [15] &quot;Fraxinus dimorpha&quot;         &quot;Fraxinus dipetala&quot;        
## [17] &quot;Fraxinus excelsior&quot;        &quot;Fraxinus ferruginea&quot;      
## [19] &quot;Fraxinus floribunda&quot;       &quot;Fraxinus gooddingii&quot;      
## [21] &quot;Fraxinus greggii&quot;          &quot;Fraxinus griffithii&quot;      
## [23] &quot;Fraxinus hookeri&quot;          &quot;Fraxinus hubeiensis&quot;      
## [25] &quot;Fraxinus insularis&quot;        &quot;Fraxinus lanuginosa&quot;      
## [27] &quot;Fraxinus latifolia&quot;        &quot;Fraxinus longicuspis&quot;     
## [29] &quot;Fraxinus malacophylla&quot;     &quot;Fraxinus mandshurica&quot;     
## [31] &quot;Fraxinus micrantha&quot;        &quot;Fraxinus nigra&quot;           
## [33] &quot;Fraxinus odontocalyx&quot;      &quot;Fraxinus ornus&quot;           
## [35] &quot;Fraxinus pallisiae&quot;        &quot;Fraxinus papillosa&quot;       
## [37] &quot;Fraxinus paxiana&quot;          &quot;Fraxinus pennsylvanica&quot;   
## [39] &quot;Fraxinus platypoda&quot;        &quot;Fraxinus potosina&quot;        
## [41] &quot;Fraxinus pringlei&quot;         &quot;Fraxinus profunda&quot;        
## [43] &quot;Fraxinus punctata&quot;         &quot;Fraxinus purpusii&quot;        
## [45] &quot;Fraxinus quadrangulata&quot;    &quot;Fraxinus raibocarpa&quot;      
## [47] &quot;Fraxinus reflexiflora&quot;     &quot;Fraxinus rufescens&quot;       
## [49] &quot;Fraxinus schiedeana&quot;       &quot;Fraxinus sieboldiana&quot;     
## [51] &quot;Fraxinus sogdiana&quot;         &quot;Fraxinus stenolepis&quot;      
## [53] &quot;Fraxinus stylosa&quot;          &quot;Fraxinus suaveolens&quot;      
## [55] &quot;Fraxinus trifoliolata&quot;     &quot;Fraxinus uhdei&quot;           
## [57] &quot;Fraxinus velutina&quot;         &quot;Fraxinus xanthoxyloides&quot;  
## [59] &quot;Fraxinus ×borzae&quot;          &quot;Fraxinus ×cataubiensis&quot;   
## [61] &quot;Fraxinus ×hybrida&quot;         &quot;Fraxinus ×rehderiana&quot;     
## [63] &quot;Fraxinus ×veltheimii&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="iteration-examples.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## there&#39;s a lot so for time sake let&#39;s just select a few species</span></span>
<span id="cb15-2"><a href="iteration-examples.html#cb15-2" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fraxinus albicans Buckley&quot;</span>, <span class="st">&quot;Fraxinus americana&quot;</span>, <span class="st">&quot;Fraxinus angustifolia&quot;</span>, <span class="st">&quot;Fraxinus anomala&quot;</span>, <span class="st">&quot;Fraxinus apertisquamifera&quot;</span>)</span>
<span id="cb15-3"><a href="iteration-examples.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="iteration-examples.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">## we need to create an empty dataframe for the loop to fill!</span></span>
<span id="cb15-5"><a href="iteration-examples.html#cb15-5" aria-hidden="true" tabindex="-1"></a>comb_species <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb15-6"><a href="iteration-examples.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="iteration-examples.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## for loop</span></span>
<span id="cb15-8"><a href="iteration-examples.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> species) {</span>
<span id="cb15-9"><a href="iteration-examples.html#cb15-9" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">download_data</span>(i)</span>
<span id="cb15-10"><a href="iteration-examples.html#cb15-10" aria-hidden="true" tabindex="-1"></a>  comb_species <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(comb_species, df)</span>
<span id="cb15-11"><a href="iteration-examples.html#cb15-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-12"><a href="iteration-examples.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">## now we get this error that numbers of columns of arguments do not match</span></span>
<span id="cb15-13"><a href="iteration-examples.html#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="iteration-examples.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Let&#39;s just select columns of interest across datasets: </span></span>
<span id="cb15-15"><a href="iteration-examples.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_FP)</span></code></pre></div>
<pre><code>##  [1] &quot;key&quot;                                &quot;scientificName&quot;                    
##  [3] &quot;decimalLatitude&quot;                    &quot;decimalLongitude&quot;                  
##  [5] &quot;issues&quot;                             &quot;datasetKey&quot;                        
##  [7] &quot;publishingOrgKey&quot;                   &quot;installationKey&quot;                   
##  [9] &quot;publishingCountry&quot;                  &quot;protocol&quot;                          
## [11] &quot;lastCrawled&quot;                        &quot;lastParsed&quot;                        
## [13] &quot;crawlId&quot;                            &quot;hostingOrganizationKey&quot;            
## [15] &quot;basisOfRecord&quot;                      &quot;occurrenceStatus&quot;                  
## [17] &quot;establishmentMeans&quot;                 &quot;taxonKey&quot;                          
## [19] &quot;kingdomKey&quot;                         &quot;phylumKey&quot;                         
## [21] &quot;classKey&quot;                           &quot;orderKey&quot;                          
## [23] &quot;familyKey&quot;                          &quot;genusKey&quot;                          
## [25] &quot;speciesKey&quot;                         &quot;acceptedTaxonKey&quot;                  
## [27] &quot;acceptedScientificName&quot;             &quot;kingdom&quot;                           
## [29] &quot;phylum&quot;                             &quot;order&quot;                             
## [31] &quot;family&quot;                             &quot;genus&quot;                             
## [33] &quot;species&quot;                            &quot;genericName&quot;                       
## [35] &quot;specificEpithet&quot;                    &quot;taxonRank&quot;                         
## [37] &quot;taxonomicStatus&quot;                    &quot;iucnRedListCategory&quot;               
## [39] &quot;continent&quot;                          &quot;year&quot;                              
## [41] &quot;month&quot;                              &quot;day&quot;                               
## [43] &quot;eventDate&quot;                          &quot;modified&quot;                          
## [45] &quot;lastInterpreted&quot;                    &quot;license&quot;                           
## [47] &quot;identifier&quot;                         &quot;facts&quot;                             
## [49] &quot;relations&quot;                          &quot;institutionKey&quot;                    
## [51] &quot;isInCluster&quot;                        &quot;recordedBy&quot;                        
## [53] &quot;identifiedBy&quot;                       &quot;geodeticDatum&quot;                     
## [55] &quot;class&quot;                              &quot;countryCode&quot;                       
## [57] &quot;recordedByIDs&quot;                      &quot;identifiedByIDs&quot;                   
## [59] &quot;country&quot;                            &quot;rightsHolder&quot;                      
## [61] &quot;eventID&quot;                            &quot;identifier.1&quot;                      
## [63] &quot;institutionID&quot;                      &quot;county&quot;                            
## [65] &quot;municipality&quot;                       &quot;locality&quot;                          
## [67] &quot;collectionCode&quot;                     &quot;gbifID&quot;                            
## [69] &quot;occurrenceID&quot;                       &quot;taxonID&quot;                           
## [71] &quot;catalogNumber&quot;                      &quot;collectionID&quot;                      
## [73] &quot;identificationID&quot;                   &quot;name&quot;                              
## [75] &quot;elevation&quot;                          &quot;stateProvince&quot;                     
## [77] &quot;references&quot;                         &quot;otherCatalogNumbers&quot;               
## [79] &quot;associatedOccurrences&quot;              &quot;recordNumber&quot;                      
## [81] &quot;habitat&quot;                            &quot;verbatimEventDate&quot;                 
## [83] &quot;http...unknown.org.recordID&quot;        &quot;institutionCode&quot;                   
## [85] &quot;rights&quot;                             &quot;startDayOfYear&quot;                    
## [87] &quot;occurrenceRemarks&quot;                  &quot;reproductiveCondition&quot;             
## [89] &quot;higherClassification&quot;               &quot;collectionKey&quot;                     
## [91] &quot;preparations&quot;                       &quot;http...unknown.org.recordEnteredBy&quot;
## [93] &quot;verbatimElevation&quot;                  &quot;networkKeys&quot;                       
## [95] &quot;individualCount&quot;                    &quot;nomenclaturalCode&quot;                 
## [97] &quot;verbatimCoordinateSystem&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="iteration-examples.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Columns we want: &quot;scientificName&quot;, &quot;decimalLatitude&quot;,&quot;decimalLongitude&quot;  </span></span>
<span id="cb17-2"><a href="iteration-examples.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="iteration-examples.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Update function</span></span>
<span id="cb17-4"><a href="iteration-examples.html#cb17-4" aria-hidden="true" tabindex="-1"></a>download_data_updated <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb17-5"><a href="iteration-examples.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  GBIFdata <span class="ot">&lt;-</span>  <span class="fu">occ_search</span>(<span class="at">scientificName =</span> x, <span class="at">limit =</span> <span class="dv">300</span>, <span class="at">hasCoordinate =</span> <span class="cn">TRUE</span>, <span class="at">basisOfRecord =</span> <span class="st">&quot;PRESERVED_SPECIMEN&quot;</span>)</span>
<span id="cb17-6"><a href="iteration-examples.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span>  GBIFdata<span class="sc">$</span>data </span>
<span id="cb17-7"><a href="iteration-examples.html#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="iteration-examples.html#cb17-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>( <span class="co"># this tells R to skip over any dataframes that did not have the columns of interest</span></span>
<span id="cb17-9"><a href="iteration-examples.html#cb17-9" aria-hidden="true" tabindex="-1"></a>  {dat <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="iteration-examples.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(scientificName <span class="sc">!=</span> <span class="st">&quot;NA&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#get rid of species name with &quot;NA&quot;</span></span>
<span id="cb17-11"><a href="iteration-examples.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(scientificName, decimalLatitude, decimalLongitude)}, </span>
<span id="cb17-12"><a href="iteration-examples.html#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">error=</span><span class="cf">function</span>(error_message) {</span>
<span id="cb17-13"><a href="iteration-examples.html#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">message</span>(<span class="st">&quot;Missing column.&quot;</span>)</span>
<span id="cb17-14"><a href="iteration-examples.html#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">message</span>(<span class="st">&quot;And below is the error message from R:&quot;</span>)</span>
<span id="cb17-15"><a href="iteration-examples.html#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">message</span>(error_message)</span>
<span id="cb17-16"><a href="iteration-examples.html#cb17-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">NA</span>)})</span>
<span id="cb17-17"><a href="iteration-examples.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(dat)</span>
<span id="cb17-18"><a href="iteration-examples.html#cb17-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-19"><a href="iteration-examples.html#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="iteration-examples.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Run for loop again and see if it works</span></span>
<span id="cb17-21"><a href="iteration-examples.html#cb17-21" aria-hidden="true" tabindex="-1"></a>comb_species <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb17-22"><a href="iteration-examples.html#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> species) {</span>
<span id="cb17-23"><a href="iteration-examples.html#cb17-23" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">download_data_updated</span>(i)</span>
<span id="cb17-24"><a href="iteration-examples.html#cb17-24" aria-hidden="true" tabindex="-1"></a>  comb_species <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(comb_species, df)</span>
<span id="cb17-25"><a href="iteration-examples.html#cb17-25" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
<div id="apply-functions" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Apply functions<a href="iteration-examples.html#apply-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another option for iteration are apply functions in base R. Check out this tutorial for more information: <a href="https://ademos.people.uic.edu/Chapter4.html" class="uri">https://ademos.people.uic.edu/Chapter4.html</a>. They often run faster than for loops &amp; can be a lot simpler to set up!</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="iteration-examples.html#cb18-1" aria-hidden="true" tabindex="-1"></a>?apply</span>
<span id="cb18-2"><a href="iteration-examples.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># just the apply function requires a matrix or dataframe to loop over, but this isn&#39;t the format of our input value which is a list...let&#39;s look at other options!</span></span>
<span id="cb18-3"><a href="iteration-examples.html#cb18-3" aria-hidden="true" tabindex="-1"></a>?lapply</span>
<span id="cb18-4"><a href="iteration-examples.html#cb18-4" aria-hidden="true" tabindex="-1"></a>?sapply</span>
<span id="cb18-5"><a href="iteration-examples.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="iteration-examples.html#cb18-6" aria-hidden="true" tabindex="-1"></a>comb_species_apply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(species, <span class="at">FUN =</span> download_data) <span class="co">#spits out a list!</span></span>
<span id="cb18-7"><a href="iteration-examples.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="iteration-examples.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># how to go from list to dataframe?</span></span>
<span id="cb18-9"><a href="iteration-examples.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># do.call calls the function you specify and runs it on the next argument</span></span>
<span id="cb18-10"><a href="iteration-examples.html#cb18-10" aria-hidden="true" tabindex="-1"></a>comb_species_apply_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;bind_rows&quot;</span>, comb_species_apply) <span class="co">#this will turn the list into a dataframe</span></span>
<span id="cb18-11"><a href="iteration-examples.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># this also helps with iterating through mulitple files</span></span></code></pre></div>
</div>
<div id="map-functions" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Map functions<a href="iteration-examples.html#map-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Apply functions are very handy, but for those dedicated to tidyverse you might be interested in the map family of functions from the purrr package (which is in the tidyverse suite of packages). Check out this tutorial for more: <a href="https://jennybc.github.io/purrr-tutorial/" class="uri">https://jennybc.github.io/purrr-tutorial/</a></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="iteration-examples.html#cb19-1" aria-hidden="true" tabindex="-1"></a>?purrr<span class="sc">::</span>map</span>
<span id="cb19-2"><a href="iteration-examples.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="iteration-examples.html#cb19-3" aria-hidden="true" tabindex="-1"></a>comb_species_map <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(species, <span class="at">.f =</span> download_data)</span>
<span id="cb19-4"><a href="iteration-examples.html#cb19-4" aria-hidden="true" tabindex="-1"></a>comb_species_map_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;bind_rows&quot;</span>, comb_species_apply)</span></code></pre></div>
<p>For fun, let’s see how the timing compares between the for loop and the apply functions.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="iteration-examples.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For Loop</span></span>
<span id="cb20-2"><a href="iteration-examples.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({ </span>
<span id="cb20-3"><a href="iteration-examples.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(comb_species)</span>
<span id="cb20-4"><a href="iteration-examples.html#cb20-4" aria-hidden="true" tabindex="-1"></a>comb_species <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb20-5"><a href="iteration-examples.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> species) {</span>
<span id="cb20-6"><a href="iteration-examples.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">download_data</span>(i)</span>
<span id="cb20-7"><a href="iteration-examples.html#cb20-7" aria-hidden="true" tabindex="-1"></a>  comb_species <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(comb_species, df)</span>
<span id="cb20-8"><a href="iteration-examples.html#cb20-8" aria-hidden="true" tabindex="-1"></a>}})</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   5.739   0.090  11.117</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="iteration-examples.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Apply</span></span>
<span id="cb22-2"><a href="iteration-examples.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(comb_species_apply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(species, <span class="at">FUN =</span> download_data))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   5.571   0.105  10.512</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="iteration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-plot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/d-rug/realworld_functions2/edit/master/02_iteration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/d-rug/realworld_functions2/blob/master/02_iteration.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
